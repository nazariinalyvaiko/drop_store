<header class="header" data-section-id="{{ section.id }}">
  <nav class="header__nav container">
    <div class="header__wrapper">
      <!-- Logo -->
      <a href="{{ routes.root_url }}" class="header__logo">
        <span class="header__logo-main">{{ section.settings.logo_text_main | default: 'VAIKO' }}</span>
        <span class="header__logo-divider"></span>
        <span class="header__logo-sub">{{ section.settings.logo_text_sub | default: 'STORE' }}</span>
      </a>

      <!-- Desktop Navigation -->
      {%- comment -%} If site menu doesn't have an About page link, render a fallback link to /pages/about {%- endcomment -%}
      {%- assign about_found = false -%}
      {%- for link in section.settings.menu.links -%}
        {%- if link.url contains '/pages/about' or link.url contains '/pages/about-us' or link.title contains 'About' or link.title contains 'Про' -%}
          {%- assign about_found = true -%}
        {%- endif -%}
      {%- endfor -%}

      <div class="header__menu">
        {%- for link in section.settings.menu.links -%}
          {%- if link.title contains 'About' or link.title contains 'Про' -%}
            {%- if pages.about -%}
              {%- assign link_href = pages.about.url -%}
            {%- else -%}
              {%- assign link_href = '/pages/about' -%}
            {%- endif -%}
          {%- elsif link.url contains '/pages/about' or link.url contains '/pages/about-us' -%}
            {%- assign link_href = link.url -%}
          {%- else -%}
            {%- assign link_href = link.url -%}
          {%- endif -%}

          <a href="{{ link_href }}" class="header__menu-link{% if link.active %} header__menu-link--active{% endif %}">
            <span>{{ link.title }}</span>
            <span class="header__menu-link-underline"></span>
          </a>
        {%- endfor -%}
        {%- if about_found == false -%}
          <a href="/pages/about" class="header__menu-link">
            <span>About</span>
            <span class="header__menu-link-underline"></span>
          </a>
        {%- endif -%}
      </div>

      <!-- Actions -->
      <div class="header__actions">
        <!-- Search Toggle -->
        {%- if section.settings.show_search -%}
          <button type="button" class="header__action-btn" aria-label="Search" data-action="search-toggle">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
          </button>
        {%- endif -%}

        <!-- Cart Button -->
        <button type="button" class="header__action-btn header__cart-btn" aria-label="Cart" data-action="cart-toggle">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
            <line x1="3" y1="6" x2="21" y2="6"/>
            <path d="M16 10a4 4 0 0 1-8 0"/>
          </svg>
          <span class="header__cart-count" data-cart-count>{{ cart.item_count }}</span>
        </button>

        <!-- Mobile Menu Toggle -->
        <button type="button" class="header__mobile-toggle" aria-label="Menu" data-action="mobile-menu-toggle">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"/>
            <line x1="3" y1="6" x2="21" y2="6"/>
            <line x1="3" y1="18" x2="21" y2="18"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div class="header__mobile-menu" data-mobile-menu>
      {%- for link in section.settings.menu.links -%}
        {%- if link.title contains 'About' or link.title contains 'Про' -%}
          {%- if pages.about -%}
            {%- assign link_href = pages.about.url -%}
          {%- else -%}
            {%- assign link_href = '/pages/about' -%}
          {%- endif -%}
        {%- elsif link.url contains '/pages/about' or link.url contains '/pages/about-us' -%}
          {%- assign link_href = link.url -%}
        {%- else -%}
          {%- assign link_href = link.url -%}
        {%- endif -%}

        <a href="{{ link_href }}" class="header__mobile-link{% if link.active %} header__mobile-link--active{% endif %}">
          {{ link.title }}
        </a>
      {%- endfor -%}
      {%- if about_found == false -%}
        <a href="/pages/about" class="header__mobile-link">About</a>
      {%- endif -%}
    </div>
  </nav>
</header>

{% style %}
  .header {
    position: sticky;
    top: 0;
    z-index: 50;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(8px);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }

  .header__nav {
    max-width: 80rem;
    margin: 0 auto;
    padding: 0 1rem;
  }

  @media (min-width: 640px) {
    .header__nav {
      padding: 0 1.5rem;
    }
  }

  @media (min-width: 1024px) {
    .header__nav {
      padding: 0 2rem;
    }
  }

  .header__wrapper {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 4rem;
  }

  @media (min-width: 768px) {
    .header__wrapper {
      height: 5rem;
    }
  }

  /* Logo */
  .header__logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    text-decoration: none;
  }

  .header__logo-main {
    font-size: 1.5rem;
    font-family: 'Space Grotesk', monospace;
    font-weight: 700;
    letter-spacing: 0.05em;
    color: #000;
  }

  .header__logo-divider {
    width: 1px;
    height: 1.5rem;
    background: rgba(0, 0, 0, 0.2);
  }

  .header__logo-sub {
    font-size: 1.5rem;
    font-family: 'Space Grotesk', monospace;
    font-weight: 300;
    letter-spacing: 0.05em;
    color: rgba(0, 0, 0, 0.6);
  }

  /* Desktop Menu */
  .header__menu {
    display: none;
    align-items: center;
    gap: 2rem;
  }

  @media (min-width: 768px) {
    .header__menu {
      display: flex;
    }
  }

  .header__menu-link {
    position: relative;
    color: rgba(0, 0, 0, 0.7);
    font-size: 0.875rem;
    font-weight: 300;
    letter-spacing: 0.05em;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .header__menu-link:hover {
    color: #000;
  }

  .header__menu-link-underline {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 1px;
    background: #000;
    transition: width 0.3s ease;
  }

  .header__menu-link:hover .header__menu-link-underline {
    width: 100%;
  }

  /* Actions */
  .header__actions {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .header__action-btn {
    position: relative;
    padding: 0.625rem;
    color: rgba(0, 0, 0, 0.7);
    background: transparent;
    border: none;
    cursor: pointer;
    transition: color 0.2s ease;
  }

  .header__action-btn:hover {
    color: #000;
  }

  .header__cart-count {
    position: absolute;
    top: -0.25rem;
    right: -0.25rem;
    width: 1.25rem;
    height: 1.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #000;
    color: #fff;
    font-size: 0.75rem;
    font-weight: 500;
    border-radius: 9999px;
  }

  .header__cart-count:empty,
  .header__cart-count[data-cart-count="0"] {
    display: none;
  }

  /* Mobile Toggle */
  .header__mobile-toggle {
    display: flex;
    padding: 0.5rem;
    color: #374151;
    background: transparent;
    border: none;
    cursor: pointer;
  }

  @media (min-width: 768px) {
    .header__mobile-toggle {
      display: none;
    }
  }

  /* Mobile Menu */
  .header__mobile-menu {
    display: none;
    flex-direction: column;
    gap: 1rem;
    padding: 1.5rem 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .header__mobile-menu.is-open {
    display: flex;
  }

  @media (min-width: 768px) {
    .header__mobile-menu {
      display: none !important;
    }
  }

  .header__mobile-link {
    color: rgba(0, 0, 0, 0.7);
    font-weight: 300;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .header__mobile-link:hover {
    color: #000;
  }
{% endstyle %}

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const mobileToggle = document.querySelector('[data-action="mobile-menu-toggle"]');
    const mobileMenu = document.querySelector('[data-mobile-menu]');
    const cartToggle = document.querySelector('[data-action="cart-toggle"]');

    if (mobileToggle && mobileMenu) {
      mobileToggle.addEventListener('click', function() {
        mobileMenu.classList.toggle('is-open');
      });
    }

    if (cartToggle) {
      cartToggle.addEventListener('click', function() {
        document.querySelector('.cart-drawer').classList.add('is-open');
        document.body.style.overflow = 'hidden';
      });
    }
  });
</script>

{% schema %}
{
  "name": "Header",
  "class": "section-header",
  "settings": [
    {
      "type": "text",
      "id": "logo_text_main",
      "label": "Logo Main Text",
      "default": "VAIKO"
    },
    {
      "type": "text",
      "id": "logo_text_sub",
      "label": "Logo Secondary Text",
      "default": "STORE"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show search",
      "default": true
    }
  ]
}
{% endschema %}

