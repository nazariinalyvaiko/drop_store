{%- comment -%}
  Marquee - Scrolling text banner
{%- endcomment -%}

<section class="marquee" data-section-id="{{ section.id }}" style="
  --marquee-bg: {{ section.settings.bg_color }};
  --marquee-text: {{ section.settings.text_color }};
  --marquee-speed: {{ section.settings.speed }}s;
">
  <div class="marquee__track {% if section.settings.direction == 'right' %}marquee__track--reverse{% endif %} {% if section.settings.pause_on_hover %}marquee__track--pausable{% endif %}">
    {%- for i in (1..3) -%}
      <div class="marquee__content">
        {%- for block in section.blocks -%}
          <span class="marquee__item" {{ block.shopify_attributes }}>
            {%- if block.settings.icon != blank -%}
              <span class="marquee__icon">{{ block.settings.icon }}</span>
            {%- endif -%}
            <span class="marquee__text" style="font-size: {{ section.settings.text_size }}rem; font-weight: {{ section.settings.font_weight }}; {% if section.settings.uppercase %}text-transform: uppercase;{% endif %} letter-spacing: {{ section.settings.letter_spacing }}em;">
              {{ block.settings.text }}
            </span>
          </span>
          <span class="marquee__separator">{{ section.settings.separator }}</span>
        {%- endfor -%}
      </div>
    {%- endfor -%}
  </div>
</section>

{% style %}
  .marquee {
    background: var(--marquee-bg);
    color: var(--marquee-text);
    overflow: hidden;
    padding: {{ section.settings.padding_y }}px 0;
    {%- if section.settings.border_top -%}
    border-top: 1px solid rgba(128, 128, 128, 0.2);
    {%- endif -%}
    {%- if section.settings.border_bottom -%}
    border-bottom: 1px solid rgba(128, 128, 128, 0.2);
    {%- endif -%}
  }

  .marquee__track {
    display: flex;
    white-space: nowrap;
    animation: marquee var(--marquee-speed) linear infinite;
  }

  .marquee__track--reverse {
    animation-direction: reverse;
  }

  .marquee__track--pausable:hover {
    animation-play-state: paused;
  }

  .marquee__content {
    display: flex;
    align-items: center;
    flex-shrink: 0;
  }

  .marquee__item {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .marquee__icon {
    font-size: 1.25em;
  }

  .marquee__text {
    font-family: 'Space Grotesk', monospace;
  }

  .marquee__separator {
    margin: 0 {{ section.settings.gap }}rem;
    opacity: 0.3;
  }

  @keyframes marquee {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-33.333%);
    }
  }
{% endstyle %}

{% schema %}
{
  "name": "Marquee",
  "tag": "section",
  "class": "section-marquee",
  "settings": [
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "text_size",
      "label": "Text Size",
      "min": 0.625, "max": 2, "step": 0.125, "default": 0.75, "unit": "rem"
    },
    {
      "type": "select",
      "id": "font_weight",
      "label": "Font Weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semi Bold" }
      ],
      "default": "400"
    },
    {
      "type": "checkbox",
      "id": "uppercase",
      "label": "Uppercase",
      "default": true
    },
    {
      "type": "range",
      "id": "letter_spacing",
      "label": "Letter Spacing",
      "min": 0, "max": 0.3, "step": 0.05, "default": 0.1, "unit": "em"
    },
    {
      "type": "header",
      "content": "Animation"
    },
    {
      "type": "range",
      "id": "speed",
      "label": "Speed",
      "min": 10, "max": 60, "step": 5, "default": 25, "unit": "s"
    },
    {
      "type": "select",
      "id": "direction",
      "label": "Direction",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "checkbox",
      "id": "pause_on_hover",
      "label": "Pause on Hover",
      "default": true
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "text",
      "id": "separator",
      "label": "Separator",
      "default": "â€¢"
    },
    {
      "type": "range",
      "id": "gap",
      "label": "Item Gap",
      "min": 1, "max": 5, "step": 0.5, "default": 2, "unit": "rem"
    },
    {
      "type": "range",
      "id": "padding_y",
      "label": "Padding",
      "min": 8, "max": 40, "step": 4, "default": 12, "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "border_top",
      "label": "Border Top",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "border_bottom",
      "label": "Border Bottom",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "item",
      "name": "Item",
      "settings": [
        {
          "type": "text",
          "id": "icon",
          "label": "Icon (emoji)"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Free Shipping"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Marquee",
      "blocks": [
        { "type": "item", "settings": { "text": "Free Shipping Worldwide", "icon": "ðŸš€" } },
        { "type": "item", "settings": { "text": "Premium Quality", "icon": "âœ“" } },
        { "type": "item", "settings": { "text": "24/7 Support", "icon": "ðŸ’¬" } },
        { "type": "item", "settings": { "text": "30-Day Returns", "icon": "â†©" } }
      ]
    }
  ]
}
{% endschema %}

